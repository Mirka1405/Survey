<!-- templates/survey.html -->
{% extends "base.html" %}

{% block content %}
<h1>Опрос: {{ roles[role] }}</h1>

<form action="{{ url_for('submit') }}{{ append_t_id }}" method="POST">
    <input type="hidden" name="role" value="{{ role }}">
    
    <div class="form-group">
        <label for="respondent_name">Имя: (обязательно)</label>
        <input type="text" id="respondent_name" name="respondent_name" 
               placeholder="Имя" required>
        <label for="member_amnt">Количество человек в команде:</label>
        <input type="text" id="member_amnt" name="member_amnt" 
               placeholder="Кол-во человек, с которыми вы работаете напрямую">
        <label for="member_cost">Стоимость за человека:</label>
        <input type="text" id="member_cost" name="member_cost" 
               placeholder="Рублей за месяц за человека">
    </div>

    <div class="category-section">
    {% for category_id, questions in role_config.items() %}
        {% for question in questions %}
        {% set question_index = loop.index0 %}
        <div class="question-item">
            <div class="question-text">{{ question }}</div>
            <div class="rating-scale">
                {% for i in range(1, 11) %}
                <div class="rating-option">
                    <input type="radio" 
                           name="rating_{{ category_id }}_{{ question_index }}" 
                           value="{{ i }}" 
                           {% if i == 5 %}checked{% endif %}
                           required>
                    <label>{{ i }}</label>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    {% endfor %}
    </div>

    {% if open_questions %}
    <div class="category-section">
        <h3>Вопросы на развернутые ответы</h3>
        {% for question in open_questions %}
        <div class="open-question">
            <label>{{ question }}</label>
            <textarea name="open_{{ loop.index0 }}" 
                      placeholder="Ответ..."></textarea>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <button type="submit">Отправить</button>
</form>
{% endblock %}